# LLM Report Tool

## 概要

「LLM Report Tool」は、ローカルのPDF、画像、またはテキスト資料の内容を参照しながら、指定したテーマ、文字数、構成、口調に基づいたレポートをOpenRouter経由で接続した大規模言語モデル（LLM）に生成させるためのデスクトップGUIアプリケーションです。

プロンプトの自動生成機能や、API実行結果の取得・保存機能を備えており、資料に基づいたレポート作成作業を効率化します。

## 特徴

*   **多様な資料形式に対応:** PDF、画像ファイル、またはテキスト資料を入力として利用可能。
*   **OpenRouter連携:** OpenRouter APIを介して、様々なLLMモデルを選択して利用できます。（利用可能なモデルはOpenRouterの仕様に依存します）
*   **柔軟な出力制御:** レポートのテーマ、希望文字数、構成（連続文章、セクション分け、箇条書き）、口調（「である/だ調」「です/ます調」）を指定可能。
*   **指示者の意見反映:** レポートに含めたい特定の視点や意見を追記可能。
*   **プロンプト自動生成:** 設定した内容に基づいて、APIに送信する詳細なプロンプトを自動生成し確認できます。
*   **API実行と結果表示:** 生成したプロンプトを基にAPIを実行し、結果をGUI上で確認できます。
*   **実行結果の保存:** 生成されたレポートテキストをファイルに保存できます。
*   **設定ファイル対応:** APIキーや利用可能なモデル、PDF読み取りエンジンなどを`config.json`で管理します。
*   **ttkbootstrapによるモダンなGUI:** 直感的で使いやすいインターフェースを提供します。

## 必要なもの

*   Python 3.x
*   OpenRouter APIキー ([OpenRouter公式サイト](https://openrouter.ai/)で取得してください)
*   以下のPythonライブラリ

## セットアップ

1.  このリポジトリをクローンするか、コードをダウンロードします。
2.  必要なライブラリをインストールします。
    ```bash
    pip install ttkbootstrap requests Pillow
    ```
    *`Pillow`は画像ファイル対応のために必要です。`ttkbootstrap`には`tkinter`が含まれています。*
3.  `config.json` ファイルを以下の内容で作成します（または、もしファイルが自動生成された場合は内容を確認・編集します）。
    ```json
    {
      "openrouter_api_key": "YOUR_OPENROUTER_API_KEY",
      "models": [
        "google/gemini-2.0-flash-exp:free",
        "meta-llama/llama-4-maverick:free",
        "qwen/qwen3-235b-a22b:free",
        "deepseek/deepseek-chat-v3-0324:free",
        "deepseek/deepseek-r1:free"
        // 利用したいOpenRouter対応モデルをここに追加/修正してください
      ],
      "pdf_engine": "pdf-text" // または "mistral-ocr", "native"
    }
    ```
    *   `YOUR_OPENROUTER_API_KEY` の部分をあなたのOpenRouter APIキーに置き換えてください。
    *   `models` リストには、OpenRouterで利用可能なモデルIDを記述します。設定ファイルがない場合は上記のデフォルトモデルが自動で設定されますが、OpenRouterのサイトで利用可能なモデルを確認し、適宜変更してください。
    *   `pdf_engine` はPDF読み取りに使用するエンジンを指定します。「pdf-text」が推奨されますが、必要に応じて「mistral-ocr」や「native」を試してください。
4.  `llm_report_tool.py` (コードのファイル名が異なる場合は適宜変更) を実行します。
    ```bash
    python llm_report_tool.py
    ```

## 使い方

1.  アプリケーションが起動したら、設定画面が表示されます。
2.  「基本設定」タブで以下の項目を設定します。
    *   **資料の種類:** レポートの基にする資料の種類を選択します（PDF, 画像, テキスト資料, 資料なし）。
        *   「PDF」または「画像」を選択した場合、「...」ボタンをクリックしてファイルを選択します。
        *   「テキスト資料」を選択した場合、下のテキストエリアに資料の内容を貼り付けます。
    *   **テーマ:** レポートの主題を入力します。
    *   **文字数:** 希望する文字数の目安を入力します（例: 800字、1000文字程度）。
    *   **構成:** レポートの文章構成を選択します。
    *   **口調:** レポートの口調を選択します。
    *   **指示者の意見・視点 (任意):** レポートに反映させたい具体的な意見や視点を追記します。
3.  「API設定」タブで以下を確認または設定します。
    *   **APIキー:** `config.json`から読み込まれます。必要に応じてここで直接編集することも可能です（編集内容は終了時に`config.json`に保存されます）。
    *   **モデル:** 利用するLLMモデルを選択します。`config.json`に設定したモデルがドロップダウンに表示されます。
    *   **PDFエンジン:** PDF資料を選択した場合に利用するエンジンを選択します。
4.  設定が完了したら、下部エリアのボタンを使用します。
    *   **プロンプト生成:** 設定した内容に基づいたプロンプトを自動生成し、「プロンプト」タブに表示します。API実行前にプロンプトの内容を確認できます。
    *   **コピー:** 現在「プロンプト」または「実行結果」タブに表示されているテキストをクリップボードにコピーします。
    *   **実行:** 設定とプロンプト内容を基にOpenRouter APIを呼び出し、LLMにレポート生成を依頼します。結果は「実行結果」タブに表示されます。
    *   **結果を保存:** 「実行結果」タブに表示されているテキストをファイルに保存します。
5.  ステータスバーに処理状況やエラーメッセージが表示されます。
6.  ウィンドウを閉じると、APIキーなどの設定内容が`config.json`に自動的に保存されます。

## 使用ライブラリ

*   ttkbootstrap ([GitHub](https://github.com/israel-mp/ttkbootstrap)) - モダンなTkinterウィジェットを提供
*   requests ([PyPI](https://pypi.org/project/requests/)) - HTTPリクエストのため
*   Pillow ([PyPI](https://pypi.org/project/Pillow/)) - 画像ファイルの扱いのため (特にBase64エンコード)
